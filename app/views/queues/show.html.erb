<div class="row wrapper border-bottom white-bg page-heading">
  <div class="col-lg-10">
    <h2><%= @work_list.name %></h2>

    <ol class="breadcrumb">
      <li>
        <%= link_to 'Home', dashboard_path %>
      </li>

      <li>
        <%= link_to 'Work lists', work_lists_path %>
      </li>

      <li class="active">
        <strong><%= @work_list.name %></strong>
      </li>
    </ol>
  </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">
  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins">
        <div class="ibox-title">
          <h5><%= @work_list.name %></h5>
        </div>

        <div class="ibox-content" style="overflow-x: scroll">
          <p><%= @work_list.details %></p>

          <input type="text" class="form-control input-sm m-b-xs" id="filter"
          placeholder="Search in table">

          <table class="footable table table-stripped" data-page-size="8" data-filter=#filter>
            <thead>
              <tr>
                <% @work_list_data.columns.each do |col| %>
                  <% next unless @work_list.visible_columns.include?(col) %>
                  <th data-sort-ignore="true"><%= col %></th>
                <% end %>

                <th data-sort-ignore="true"></th>
              </tr>
            </thead>

            <tbody>
              <% @work_list_data.to_hash.each do |row| %>

                <tr data-work-list-item='<%= row.select { |k, v| @work_list.visible_columns.include?(k) }.to_json %>' data-work-list-table='<%= @work_list.data_table_name %>'>
                  <% row.each do |k, v|  %>
                  <% next unless @work_list.visible_columns.include?(k) %>
                    <td>
                      <%= v %>
                    </td>
                  <% end %>
                  <td>
                    <a href="#" class="show-work-list-item-btn">view</a>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="modal-form" class="modal fade" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-body" style="padding: 0">
        <div class="row" style="background-color: #eaeaea;">
          <div class="col-sm-5 b-r" style="padding: 50px 25px">
            <h3 class="m-t-none m-b">
              <%= @work_list.name %>
            </h3>

            <p>
              <%= @work_list.details %>
            </p>

            <div class="work_list_item_data">
            </div>

            <div class="text-center" style="margin-top: 60px">
              <% @work_list.outcomes.each_with_index do |outcome_attributes, index| %>
                <% @outcome = WorkListOutcome.new(outcome_attributes["outcome"]) %>
                <% if index == 0 %>
                  <button type="button" class="btn btn-primary" data-dismiss="modal" style="width:160px;margin-bottom: 15px"><%= @outcome.detail %></button><br>
                <% else %>
                  <button type="button" class="btn btn-default" data-dismiss="modal" style="width:160px;margin-bottom: 15px"><%= @outcome.detail %></button><br>
                <% end %>
              <% end %>
            </div>
          </div>

          <div class="col-sm-7" style="background-color: white;padding: 50px 25px;min-height: 500px">
            <h5>Activity history</h5>
            <hr>

            <%= render 'shared/activity_history', feedable_type: @work_list.data_table_name.singularize, feedable_id: 1 %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
