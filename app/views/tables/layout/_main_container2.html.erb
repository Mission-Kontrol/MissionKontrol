<% fields_for_main_container2(layout_builder).each do |index, field| %>
  <% if field["table"] == @current_table %>
    <% @current_row = @row %>
  <% else %>
    <% @current_row = get_related_row(@current_table, field["table"], @row["id"]) %>
  <% end %>

  <% if field["editable"] == "true" %>
    <div class="row editable-row">
      <div class="col-xs-12">
        <div class="editable-content-wrapper">
          <p class="main-container-content">
            <b><%= field["title"] %></b>:

            <span class="editable-content" onclick="showEditable(event);">
              <% if current_row_valid?(@current_row, field) %>
                <%= @current_row[field["title"]] %>
              <% else %>
                --
              <% end %>
            </span>
          </p>
        </div>

        <div class="editable-input">
          <% if @current_row %>

            <% if field["table"] == @current_table %>
              <% if field["kind"] == 'integer' %>
                <input type="number" class="form-control" value="<%= @current_row.nil? ? "" : @current_row[field["title"]] %>" data-table="<%= field["table"] %>" data-field="<%= field["title"] %>" data-id="<%= params[:record_id] %>">
              <% else %>
                <input type="text" class="form-control" value="<%= @current_row.nil? ? "" : @current_row[field["title"]] %>" data-table="<%= field["table"] %>" data-field="<%= field["title"] %>" data-id="<%= params[:record_id] %>">
              <% end %>
            <% else %>
              <% if field["kind"] == 'integer' %>
                <input type="number" class="form-control" value="<%= @current_row.nil? ? "" : @current_row[field["title"]] %>" data-table="<%= field["table"] %>" data-field="<%= field["title"] %>" data-id="<%= params[:record_id] %>" data-foreign-key-title="<%= get_foreign_key(@current_table) %>" data-foreign-key-value="<%= params[:record_id] %>">
              <% else %>
                <input type="text" class="form-control" value="<%= @current_row.nil? ? "" : @current_row[field["title"]] %>" data-table="<%= field["table"] %>" data-field="<%= field["title"] %>" data-foreign-key-title="<%= get_foreign_key(@current_table) %>" data-foreign-key-value="<%= params[:record_id] %>">
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <div class="">
      <p class="main-container-content">
        <b><%= field["title"].humanize %></b>:

        <span class="">
          <% if @current_row &&  !@current_row[field["title"]].blank? %>
            <%= @current_row[field["title"]] %>
          <% else %>
              --
          <% end %>
        </span>
      </p>
    </div>
  <% end %>
<% end  %>
